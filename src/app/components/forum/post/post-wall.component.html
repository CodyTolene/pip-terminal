@if (loading()) {
  <pip-loading center />
  <p class="loading">
    <i>LOADING POSTS</i>
  </p>
} @else {
  @if (posts().length > 0) {
    <div class="actions">
      @if (authorId) {
        <pip-title h2>MY POSTS</pip-title>
      } @else {
        <pip-title h2>ALL POSTS</pip-title>
      }
      <form>
        <pro-input-dropdown
          [formControl]="postSortOrderFormControl"
          hideHint
          label="Sorting"
        >
          <pro-input-dropdown-option
            [value]="{ key: 'createdAt', direction: 'asc' }"
            >Oldest First</pro-input-dropdown-option
          >
          <pro-input-dropdown-option
            [value]="{ key: 'createdAt', direction: 'desc' }"
            >Newest First</pro-input-dropdown-option
          >
        </pro-input-dropdown>
      </form>
    </div>
    @for (post of posts(); track post.id) {
      <pip-panel>
        <pip-forum-post-display [post]="post" linkedPost simple />
      </pip-panel>
    }
    @if (showAds()) {
      <pip-adsense-unit
        [fullWidthResponsive]="true"
        adClient="ca-pub-4966893083726404"
        adSlot="4516696288"
      />
    }
    <div class="pagination">
      <pip-button
        (click)="prevPagePosts()"
        [disabled]="loading() || !hasPrevPage()"
        [matTooltip]="'Previous Page'"
      >
        <mat-icon fontSet="material-icons-outlined">chevron_left</mat-icon>
      </pip-button>
      <pip-button
        (click)="nextPagePosts()"
        [disabled]="loading() || !hasNextPage()"
        [matTooltip]="'Next Page'"
      >
        <mat-icon fontSet="material-icons-outlined">chevron_right</mat-icon>
      </pip-button>
    </div>
  } @else {
    @if (userChanges | async) {
      @if (authorId) {
        <pip-title h2>MY POSTS</pip-title>
        <p>
          You haven't posted anything to the forum yet.
          <a [routerLink]="forumNewPostLink" class="action-link"
            >Create your first post now!</a
          >
        </p>
      } @else {
        <p>No posts yet. Be the first to share something!</p>
      }
    } @else {
      <p>
        No posts yet. Please
        <a [routerLink]="loginLink" class="action-link">log in</a>or
        <a [routerLink]="registerLink" class="action-link">register</a>to share
        something!
      </p>
    }
  }
}
